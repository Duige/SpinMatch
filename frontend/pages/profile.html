<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æˆ‘çš„ - SpinMatch</title>
    
    <!-- é˜²é—ªç™½çš„å…³é”®CSS -->
    <style>
        html { background-color: #1a1a1a !important; }
        body { background-color: #1a1a1a !important; opacity: 1 !important; }
    </style>
    
    <link rel="stylesheet" href="../styles/styles.css">
    <link rel="stylesheet" href="../styles/profile.css">
    <link rel="stylesheet" href="../styles/page-transitions.css">
    <link rel="stylesheet" href="../styles/auth-styles.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <!-- ä¼˜åŒ–åçš„ç»Ÿä¸€æ ·å¼ -->
    <style>
        /* ===== å¯¼èˆªæ æ ·å¼ ===== */
        .navbar {
            position: fixed !important;
            top: 0 !important;
            width: 100% !important;
            z-index: 1000 !important;
            background: rgba(0, 0, 0, 0.3) !important;
            backdrop-filter: blur(15px) !important;
            -webkit-backdrop-filter: blur(15px) !important;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1) !important;
            transition: all 0.3s ease !important;
            padding: 1rem 0 !important;
            box-shadow: 0 2px 20px rgba(0, 0, 0, 0.1) !important;
        }

        .navbar:hover { background: rgba(0, 0, 0, 0.4) !important; }

        .nav-container {
            display: flex !important;
            justify-content: space-between !important;
            align-items: center !important;
            max-width: 1200px !important;
            margin: 0 auto !important;
            padding: 0 20px !important;
            position: relative !important;
        }

        .nav-menu {
            display: flex !important;
            list-style: none !important;
            gap: 3rem !important;
            margin: 0 !important;
            padding: 0 !important;
            position: absolute !important;
            left: 50% !important;
            transform: translateX(-50%) !important;
            align-items: center !important;
        }

        .nav-menu li { list-style: none !important; margin: 0 !important; padding: 0 !important; }

        .nav-menu a {
            color: white !important;
            font-weight: 500 !important;
            transition: all 0.3s ease !important;
            position: relative !important;
            padding: 8px 16px !important;
            border-radius: 15px !important;
            text-decoration: none !important;
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
            white-space: nowrap !important;
        }

        .nav-menu a:hover {
            color: #FFD700 !important;
            background: rgba(255, 215, 0, 0.1) !important;
            transform: translateY(-2px) !important;
        }

        .nav-menu a.active {
            color: #DC143C !important;
            background: rgba(220, 20, 60, 0.1) !important;
        }

        .nav-menu a::after {
            content: '' !important;
            position: absolute !important;
            bottom: -5px !important;
            left: 50% !important;
            transform: translateX(-50%) !important;
            width: 0 !important;
            height: 2px !important;
            background: #FFD700 !important;
            transition: width 0.3s ease !important;
        }

        .nav-menu a:hover::after, .nav-menu a.active::after { width: 80% !important; }
        .nav-menu a.active::after { background: #DC143C !important; }

        .nav-auth {
            display: flex !important;
            gap: 1rem !important;
            margin-left: auto !important;
            z-index: 10 !important;
            align-items: center !important;
        }

        /* ===== æŒ‰é’®æ ·å¼ ===== */
        .btn-login, .btn-register {
            padding: 8px 18px !important;
            border-radius: 20px !important;
            font-weight: 600 !important;
            transition: all 0.3s ease !important;
            border: 2px solid transparent !important;
            font-size: 14px !important;
            cursor: pointer !important;
            text-decoration: none !important;
            display: inline-flex !important;
            align-items: center !important;
            justify-content: center !important;
            white-space: nowrap !important;
        }

        .btn-login {
            background: linear-gradient(45deg, #FF6B35, #DC143C) !important;
            color: white !important;
            box-shadow: 0 3px 12px rgba(220, 20, 60, 0.4) !important;
            border: 2px solid rgba(255, 255, 255, 0.2) !important;
        }

        .btn-login:hover {
            transform: translateY(-2px) !important;
            box-shadow: 0 6px 20px rgba(220, 20, 60, 0.6) !important;
            border: 2px solid rgba(255, 255, 255, 0.4) !important;
        }

        .btn-register {
            background: linear-gradient(45deg, #FFD700, #FFA500) !important;
            color: #1a1a1a !important;
            box-shadow: 0 3px 12px rgba(255, 215, 0, 0.4) !important;
            border: 2px solid rgba(255, 255, 255, 0.2) !important;
            font-weight: 700 !important;
        }

        .btn-register:hover {
            transform: translateY(-2px) !important;
            box-shadow: 0 6px 20px rgba(255, 215, 0, 0.6) !important;
            border: 2px solid rgba(255, 255, 255, 0.4) !important;
        }

        .hamburger { display: none !important; }

        /* ===== ä¸ªäººèµ„æ–™ä¸“ç”¨æ ·å¼ ===== */
        .profile-bio {
            margin-top: 1rem;
            padding: 0.8rem;
            background: rgba(248, 249, 250, 0.8);
            border-radius: 8px;
            border-left: 3px solid #DC143C;
        }

        .profile-bio p {
            margin: 0;
            color: #555;
            font-size: 0.9rem;
            line-height: 1.5;
            font-style: italic;
        }

        /* ===== é€šç”¨é¡¹ç›®æ ·å¼ ===== */
        .record-item, .post-item {
            background: white;
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
        }

        .record-item { border-left: 4px solid #DC143C; }
        .post-item { border-left: 4px solid #17a2b8; }
        .record-item:hover, .post-item:hover { transform: translateY(-2px); box-shadow: 0 4px 16px rgba(0,0,0,0.15); }

        .record-header, .post-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .record-header h4, .post-header h4 { margin: 0; color: #2c3e50; font-size: 1.1rem; }

        .record-status {
            padding: 0.3rem 0.8rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 500;
        }

        .record-status.active { background: #d4edda; color: #155724; }
        .record-status.completed { background: #cce5ff; color: #004085; }
        .record-status.cancelled { background: #f8d7da; color: #721c24; }
        .record-status.registered { background: #fff3cd; color: #856404; }
        .record-status.participated { background: #d1ecf1; color: #0c5460; }

        .record-details p, .post-content p { margin: 0.5rem 0; color: #666; font-size: 0.9rem; line-height: 1.6; }
        .record-details i, .post-stats i { width: 16px; margin-right: 0.5rem; color: #DC143C; }

        .record-actions { display: flex; gap: 0.5rem; margin-top: 1rem; }
        .record-actions button { padding: 0.4rem 0.8rem; border-radius: 6px; font-size: 0.8rem; border: none; cursor: pointer; transition: all 0.2s ease; }

        .post-tags { margin: 1rem 0; }
        .post-tags .tag { display: inline-block; background: #f8f9fa; color: #495057; padding: 0.2rem 0.6rem; border-radius: 12px; font-size: 0.8rem; margin-right: 0.5rem; margin-bottom: 0.3rem; }
        .post-stats { display: flex; gap: 1rem; margin-top: 1rem; padding-top: 1rem; border-top: 1px solid #e9ecef; }
        .post-stats span { color: #666; font-size: 0.9rem; }
        .post-date { color: #666; font-size: 0.8rem; }

        /* ===== é€šç”¨çš„ç©ºçŠ¶æ€æ ·å¼ ===== */
        .no-records {
            text-align: center;
            padding: 3rem 2rem;
            color: #666;
        }

        .no-records i {
            font-size: 3rem;
            color: #ddd;
            margin-bottom: 1rem;
        }

        .no-records p {
            font-size: 1.1rem;
            margin-bottom: 0.5rem;
            color: #333;
        }

        .no-records span {
            font-size: 0.9rem;
            color: #666;
            display: block;
            margin-bottom: 1.5rem;
        }

        .no-records .btn-primary {
            padding: 0.8rem 1.5rem;
            font-size: 1rem;
        }

        /* ===== æ´»åŠ¨é¡¹æ ·å¼ ===== */
        .activity-item {
            display: flex;
            align-items: center;
            padding: 1rem;
            margin-bottom: 0.5rem;
            background: white;
            border-radius: 8px;
            box-shadow: 0 1px 4px rgba(0,0,0,0.1);
            transition: all 0.2s ease;
        }

        .activity-item:hover { transform: translateX(5px); box-shadow: 0 2px 8px rgba(0,0,0,0.15); }

        .activity-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 1rem;
            color: white;
            font-size: 1.1rem;
        }

        .activity-content { flex: 1; }
        .activity-content p { margin: 0; color: #2c3e50; font-weight: 500; }
        .activity-date { color: #666; font-size: 0.8rem; }

        /* ===== æˆå°±å¾½ç« æ ·å¼ ===== */
        .achievement-item.unlocked {
            background: linear-gradient(135deg, #fff, #f8f9fa);
            border: 2px solid #28a745;
            color: #155724;
        }

        .achievement-item.unlocked .achievement-icon {
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
        }

        .unlock-date { color: #28a745; font-size: 0.8rem; font-weight: 500; }

        /* ===== Profileé¡µé¢æŒ‰é’®æ ·å¼ ===== */
        .profile-actions .btn-primary,
        .profile-actions .btn-secondary {
            padding: 0.8rem 1.5rem !important;
            border-radius: 25px !important;
            font-weight: 500 !important;
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
            gap: 0.5rem !important;
            transition: all 0.3s ease !important;
            border: 2px solid transparent !important;
            cursor: pointer !important;
            text-decoration: none !important;
            font-size: 14px !important;
            min-height: 44px !important;
            white-space: nowrap !important;
            opacity: 1 !important;
            visibility: visible !important;
        }
        
        .profile-actions .btn-primary {
            background: linear-gradient(135deg, #DC143C, #B91C3C) !important;
            color: white !important;
            border-color: #DC143C !important;
        }
        
        .profile-actions .btn-primary:hover {
            background: linear-gradient(135deg, #B91C3C, #A01B3D) !important;
            transform: translateY(-2px) !important;
            box-shadow: 0 5px 15px rgba(220, 20, 60, 0.3) !important;
        }
        
        .profile-actions .btn-secondary {
            background: white !important;
            color: #DC143C !important;
            border-color: #DC143C !important;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1) !important;
        }
        
        .profile-actions .btn-secondary:hover {
            background: #DC143C !important;
            color: white !important;
            transform: translateY(-2px) !important;
            box-shadow: 0 5px 15px rgba(220, 20, 60, 0.3) !important;
        }

        .avatar-container { cursor: pointer !important; position: relative !important; }
        .avatar-overlay { cursor: pointer !important; }

        /* ===== æ¨¡æ€æ¡†æ ·å¼ ===== */
        .modal {
            position: fixed !important;
            top: 0 !important;
            left: 0 !important;
            width: 100% !important;
            height: 100% !important;
            background: rgba(0, 0, 0, 0.8) !important;
            display: none !important;
            justify-content: center !important;
            align-items: center !important;
            z-index: 10000 !important;
        }
        
        .modal.show { display: flex !important; }

        /* ===== é€šç”¨æ¨¡æ€æ¡†å†…å®¹æ ·å¼ ===== */
        .modal-content {
            background: white !important;
            border-radius: 15px !important;
            padding: 2rem !important;
            max-width: 400px !important;
            width: 90% !important;
            max-height: 90vh !important;
            overflow-y: auto !important;
            position: relative !important;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3) !important;
        }

        .modal-content .close {
            position: absolute !important;
            right: 20px !important;
            top: 20px !important;
            width: 30px !important;
            height: 30px !important;
            border-radius: 50% !important;
            background: rgba(220, 20, 60, 0.1) !important;
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
            font-size: 18px !important;
            color: #DC143C !important;
            cursor: pointer !important;
            transition: all 0.3s ease !important;
            border: 2px solid #DC143C !important;
            font-weight: bold !important;
        }

        .modal-content .close:hover {
            background: #DC143C !important;
            color: white !important;
            transform: scale(1.1) !important;
        }

        /* ===== è®¤è¯è¡¨å•æ ·å¼ ===== */
        .auth-form {
            width: 100% !important;
        }

        .auth-form h2 {
            text-align: center !important;
            margin-bottom: 1.5rem !important;
            color: #333 !important;
            font-size: 1.5rem !important;
            font-weight: 600 !important;
        }

        .auth-form .form-group {
            margin-bottom: 1rem !important;
        }

        .auth-form .form-group label {
            display: block !important;
            margin-bottom: 0.5rem !important;
            font-weight: 500 !important;
            color: #374151 !important;
        }

        .auth-form .form-group input,
        .auth-form .form-group select {
            width: 100% !important;
            padding: 12px 16px !important;
            border: 2px solid #e5e7eb !important;
            border-radius: 8px !important;
            font-size: 16px !important;
            transition: all 0.3s ease !important;
            background: #fff !important;
            box-sizing: border-box !important;
        }

        .auth-form .form-group input:focus,
        .auth-form .form-group select:focus {
            outline: none !important;
            border-color: #DC143C !important;
            box-shadow: 0 0 0 3px rgba(220, 20, 60, 0.1) !important;
        }

        .auth-form .checkbox-label {
            display: flex !important;
            align-items: center !important;
            gap: 0.5rem !important;
            cursor: pointer !important;
        }

        .auth-form .btn-primary {
            width: 100% !important;
            padding: 12px !important;
            background: linear-gradient(135deg, #DC143C, #B91C3C) !important;
            color: white !important;
            border: none !important;
            border-radius: 8px !important;
            font-size: 16px !important;
            font-weight: 600 !important;
            cursor: pointer !important;
            transition: all 0.3s ease !important;
            margin-top: 1rem !important;
        }

        .auth-form .btn-primary:hover {
            background: linear-gradient(135deg, #B91C3C, #A01B3D) !important;
            transform: translateY(-1px) !important;
            box-shadow: 0 4px 12px rgba(220, 20, 60, 0.3) !important;
        }

        .auth-form .auth-switch {
            text-align: center !important;
            margin-top: 1rem !important;
            color: #666 !important;
            font-size: 14px !important;
        }

        .auth-form .auth-switch a {
            color: #DC143C !important;
            text-decoration: none !important;
            font-weight: 500 !important;
        }

        .auth-form .auth-switch a:hover {
            text-decoration: underline !important;
        }

        /* ===== ç¼–è¾‘èµ„æ–™æ¨¡æ€æ¡† ===== */
        #editProfileModal .modal-content {
            max-width: 800px !important;
            max-height: 90vh !important;
            margin: 2vh auto !important;
            overflow: visible !important;
            display: block !important;
        }
        
        #editProfileModal .modal-content h2 {
            padding: 25px 30px 20px 30px !important;
            margin: 0 !important;
            border-bottom: 1px solid #e9ecef !important;
            background: #fff !important;
        }
        
        #editProfileModal .profile-form {
            padding: 30px !important;
            max-height: calc(80vh - 60px) !important;
            overflow-y: auto !important;
        }

        /* æ»šåŠ¨æ¡æ ·å¼ */
        #editProfileModal .profile-form::-webkit-scrollbar { width: 8px; }
        #editProfileModal .profile-form::-webkit-scrollbar-track { background: #f1f1f1; border-radius: 4px; }
        #editProfileModal .profile-form::-webkit-scrollbar-thumb { background: #DC143C; border-radius: 4px; }
        #editProfileModal .profile-form::-webkit-scrollbar-thumb:hover { background: #B91C3C; }

        /* è¡¨å•æ ·å¼ */
        #editProfileModal .form-group { margin-bottom: 1.5rem !important; }
        #editProfileModal .form-row { display: grid !important; grid-template-columns: 1fr 1fr !important; gap: 1.5rem !important; margin-bottom: 1.5rem !important; }
        #editProfileModal .form-group label { display: block !important; margin-bottom: 0.5rem !important; font-weight: 600 !important; color: #374151 !important; font-size: 14px !important; }
        
        #editProfileModal .form-group input,
        #editProfileModal .form-group select,
        #editProfileModal .form-group textarea {
            width: 100% !important;
            padding: 12px 16px !important;
            border: 2px solid #e5e7eb !important;
            border-radius: 8px !important;
            font-size: 16px !important;
            transition: all 0.3s ease !important;
            background: #fff !important;
            box-sizing: border-box !important;
        }
        
        #editProfileModal .form-group input:focus,
        #editProfileModal .form-group select:focus,
        #editProfileModal .form-group textarea:focus {
            outline: none !important;
            border-color: #DC143C !important;
            box-shadow: 0 0 0 3px rgba(220, 20, 60, 0.1) !important;
        }
        
        #editProfileModal .form-group textarea { resize: vertical !important; min-height: 100px !important; }

        /* ç¤¾äº¤åª’ä½“è¾“å…¥æ¡† */
        #editProfileModal .social-inputs { display: flex !important; flex-direction: column !important; gap: 1rem !important; }
        
        #editProfileModal .social-input {
            display: flex !important;
            align-items: center !important;
            gap: 12px !important;
            padding: 12px 16px !important;
            border: 2px solid #e5e7eb !important;
            border-radius: 8px !important;
            transition: all 0.3s ease !important;
            background: #fff !important;
        }
        
        #editProfileModal .social-input:focus-within { border-color: #DC143C !important; box-shadow: 0 0 0 3px rgba(220, 20, 60, 0.1) !important; }
        #editProfileModal .social-input i { color: #DC143C !important; width: 20px !important; text-align: center !important; font-size: 16px !important; }
        #editProfileModal .social-input input { flex: 1 !important; border: none !important; outline: none !important; padding: 0 !important; background: transparent !important; box-shadow: none !important; }

        /* è¡¨å•æ“ä½œæŒ‰é’® */
        #editProfileModal .form-actions { display: flex !important; justify-content: flex-end !important; gap: 1rem !important; margin-top: 2rem !important; padding-top: 1.5rem !important; border-top: 1px solid #e9ecef !important; }
        #editProfileModal .form-actions button { padding: 12px 24px !important; border-radius: 8px !important; font-weight: 600 !important; font-size: 16px !important; cursor: pointer !important; transition: all 0.3s ease !important; border: 2px solid transparent !important; min-width: 120px !important; }
        
        #editProfileModal .btn-primary {
            background: linear-gradient(135deg, #DC143C, #B91C3C) !important;
            color: white !important;
            border-color: #DC143C !important;
        }
        
        #editProfileModal .btn-primary:hover {
            background: linear-gradient(135deg, #B91C3C, #A01B3D) !important;
            transform: translateY(-1px) !important;
            box-shadow: 0 4px 12px rgba(220, 20, 60, 0.3) !important;
        }
        
        #editProfileModal .btn-secondary { background: #fff !important; color: #6b7280 !important; border-color: #d1d5db !important; }
        #editProfileModal .btn-secondary:hover { background: #f9fafb !important; border-color: #9ca3af !important; color: #374151 !important; }

        /* åªè¯»å­—æ®µæ ·å¼ */
        #editProfileModal .form-group input[readonly] { background: #f8f9fa !important; color: #6c757d !important; cursor: not-allowed !important; border-color: #e9ecef !important; }
        #editProfileModal .form-group input[readonly]:focus { border-color: #e9ecef !important; box-shadow: none !important; }

        /* ç¼–è¾‘èµ„æ–™æ¨¡æ€æ¡†çš„å…³é—­æŒ‰é’®ç‰¹æ®Šæ ·å¼ */
        #editProfileModal .close {
            width: 40px !important;
            height: 40px !important;
            font-size: 20px !important;
            z-index: 999999 !important;
        }

        /* ===== å“åº”å¼è®¾è®¡ ===== */
        @media (max-width: 768px) {
            .nav-menu { display: none !important; position: static !important; transform: none !important; }
            .nav-auth { margin-left: auto !important; }
            .nav-container { justify-content: space-between !important; }
            #editProfileModal .modal-content { max-width: 95% !important; margin: 1vh auto !important; }
            #editProfileModal .form-row { grid-template-columns: 1fr !important; gap: 1rem !important; }
            #editProfileModal .profile-form { padding: 20px !important; }
            #editProfileModal .modal-content h2 { padding: 20px 20px 15px 20px !important; font-size: 20px !important; }
            #editProfileModal .close { right: 20px !important; top: 20px !important; }
        }
        
        @media (max-width: 480px) {
            #editProfileModal .modal-content { max-width: 98% !important; max-height: 95vh !important; }
            #editProfileModal .profile-form { padding: 16px !important; }
            #editProfileModal .form-actions { flex-direction: column !important; gap: 0.5rem !important; }
            #editProfileModal .form-actions button { width: 100% !important; min-width: unset !important; }
        }

        /* ===== ç”¨æˆ·èœå•æ ·å¼ ===== */
        .user-menu {
            display: flex !important;
            align-items: center !important;
            gap: 1rem !important;
        }
        
        .username {
            color: white !important;
            font-weight: 500 !important;
            font-size: 14px !important;
        }
        
        .btn-logout {
            padding: 8px 18px !important;
            border-radius: 20px !important;
            font-weight: 600 !important;
            transition: all 0.3s ease !important;
            border: 2px solid #ff6b6b !important;
            font-size: 14px !important;
            cursor: pointer !important;
            text-decoration: none !important;
            display: inline-flex !important;
            align-items: center !important;
            justify-content: center !important;
            white-space: nowrap !important;
            background: rgba(255, 107, 107, 0.1) !important;
            color: #ff6b6b !important;
        }
        
        .btn-logout:hover {
            background: #ff6b6b !important;
            color: white !important;
            transform: translateY(-2px) !important;
            box-shadow: 0 4px 12px rgba(255, 107, 107, 0.3) !important;
        }
    </style>

    <!-- å…¨å±€å¸¸é‡å®šä¹‰ -->
    <script>
        // å®šä¹‰å¸¸ç”¨çš„é€‰é¡¹å’Œå¸¸é‡
        const LEVEL_OPTIONS = [
            { value: 'beginner', label: 'åˆå­¦è€…' },
            { value: 'intermediate', label: 'ä¸­çº§' },
            { value: 'advanced', label: 'é«˜çº§' },
            { value: 'professional', label: 'ä¸“ä¸š' }
        ];

        const DEFAULT_AVATAR = "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='120' height='120' viewBox='0 0 120 120'%3E%3Ccircle cx='60' cy='60' r='60' fill='%23f8f9fa'/%3E%3Ccircle cx='60' cy='45' r='20' fill='%23DC143C'/%3E%3Cpath d='M20 100 Q60 80 100 100 L100 120 L20 120 Z' fill='%23DC143C'/%3E%3C/svg%3E";

        // æˆå°±å¾½ç« æ•°æ®å¸¸é‡
        const ACHIEVEMENT_DATA = [
            { icon: 'fas fa-handshake', title: 'åˆæ¬¡çº¦çƒ', description: 'å®Œæˆç¬¬ä¸€æ¬¡çº¦çƒæ´»åŠ¨', target: 1 },
            { icon: 'fas fa-trophy', title: 'èµ›äº‹æ–°æ‰‹', description: 'å‚åŠ ç¬¬ä¸€ä¸ªèµ›äº‹', target: 1 },
            { icon: 'fas fa-pen', title: 'ç¤¾åŒºæ–°äºº', description: 'å‘å¸ƒç¬¬ä¸€æ¡åŠ¨æ€', target: 1 },
            { icon: 'fas fa-heart', title: 'äººæ°”æ–°æ˜Ÿ', description: 'è·å¾—10ä¸ªç‚¹èµ', target: 10 }
        ];

        // ç”ŸæˆæŠ€æœ¯æ°´å¹³é€‰é¡¹çš„è¾…åŠ©å‡½æ•°
        function generateLevelOptions(includeEmpty = false) {
            let options = '';
            if (includeEmpty) {
                options += '<option value="">è¯·é€‰æ‹©</option>';
            }
            LEVEL_OPTIONS.forEach(option => {
                options += `<option value="${option.value}">${option.label}</option>`;
            });
            return options;
        }

        // ç”Ÿæˆæˆå°±å¾½ç« é¡¹HTML
        function generateAchievementItem(achievement, isUnlocked = false, currentProgress = 0) {
            const statusClass = isUnlocked ? 'unlocked' : 'locked';
            const progressText = isUnlocked ? 
                `<span class="unlock-date">å·²è§£é”</span>` : 
                `<span class="progress">è¿›åº¦ï¼š${currentProgress}/${achievement.target}</span>`;
                
            return `
                <div class="achievement-item ${statusClass}">
                    <div class="achievement-icon">
                        <i class="${achievement.icon}"></i>
                    </div>
                    <h4>${achievement.title}</h4>
                    <p>${achievement.description}</p>
                    ${progressText}
                </div>
            `;
        }
    </script>
</head>
<body>
    <!-- å¯¼èˆªæ  -->
    <nav class="navbar">
        <div class="nav-container">
            <ul class="nav-menu">
                <li><a href="index.html">é¦–é¡µ</a></li>
                <li><a href="booking.html">çº¦çƒ</a></li>
                <li><a href="events.html">èµ›äº‹</a></li>
                <li><a href="community.html">ç¤¾åŒº</a></li>
                <li><a href="news.html">èµ„è®¯</a></li>
                <li><a href="profile.html" class="active">æˆ‘çš„</a></li>
            </ul>
            <div class="nav-auth">
                <button class="btn-login" onclick="openModal('loginModal')">ç™»å½•</button>
                <button class="btn-register" onclick="openModal('registerModal')">æ³¨å†Œ</button>
            </div>
            <div class="hamburger">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
    </nav>

    <!-- é¡µé¢å¤´éƒ¨ -->
    <section class="page-header">
        <div class="container">
            <h1>ä¸ªäººä¸­å¿ƒ</h1>
            <p>ç®¡ç†æ‚¨çš„ä¸ªäººä¿¡æ¯å’Œä¹’ä¹“çƒæ•°æ®</p>
        </div>
    </section>

    <!-- ä¸»è¦å†…å®¹åŒºåŸŸ -->
    <section class="profile-main">
        <div class="container">
            <div class="profile-layout">
                <!-- å·¦ä¾§ä¸ªäººä¿¡æ¯ -->
                <div class="profile-sidebar">
                    <!-- ä¸ªäººä¿¡æ¯å¡ç‰‡ -->
                    <div class="profile-card">
                        <div class="profile-avatar-section">
                            <div class="avatar-container">
                                <img src="" alt="é»˜è®¤å¤´åƒ" class="profile-avatar" id="profileAvatar">
                                <div class="avatar-overlay" onclick="changeAvatar()">
                                    <i class="fas fa-camera"></i>
                                    <span>æ›´æ¢å¤´åƒ</span>
                                </div>
                            </div>
                            <div class="profile-basic-info">
                                <h2 id="profileName">æ‚¨çš„å§“å</h2>
                                <span class="user-level" id="profileLevel">æŠ€æœ¯æ°´å¹³</span>
                                <p class="profile-title" id="profileTitle">èŒä¸š/å¤´è¡”</p>
                                <div class="profile-location">
                                    <i class="fas fa-map-marker-alt"></i>
                                    <span id="profileLocation">æ‰€åœ¨åœ°åŒº</span>
                                </div>
                                <div class="profile-bio">
                                    <p id="profileBioText">ä¸ªäººç®€ä»‹</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="profile-stats">
                            <div class="stat-item">
                                <span class="stat-number" id="bookingCount">0</span>
                                <span class="stat-label">çº¦çƒæ¬¡æ•°</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-number" id="eventCount">0</span>
                                <span class="stat-label">å‚ä¸èµ›äº‹</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-number" id="fansCount">0</span>
                                <span class="stat-label">ç¤¾åŒºç²‰ä¸</span>
                            </div>
                        </div>
                        
                        <div class="profile-actions">
                            <button class="btn-primary" onclick="openEditProfile()">
                                <i class="fas fa-edit"></i>
                                ç¼–è¾‘èµ„æ–™
                            </button>
                            <button class="btn-secondary" onclick="shareProfile()">
                                <i class="fas fa-share"></i>
                                åˆ†äº«åç‰‡
                            </button>
                        </div>
                    </div>

                    <!-- å¿«æ·æ“ä½œ -->
                    <div class="quick-actions">
                        <h3>å¿«æ·æ“ä½œ</h3>
                        <div class="action-list">
                            <a href="booking.html" class="action-item">
                                <i class="fas fa-plus"></i>
                                <span>å‘å¸ƒçº¦çƒ</span>
                            </a>
                            <a href="events.html" class="action-item">
                                <i class="fas fa-trophy"></i>
                                <span>æŠ¥åèµ›äº‹</span>
                            </a>
                            <a href="community.html" class="action-item">
                                <i class="fas fa-pen"></i>
                                <span>å‘å¸ƒåŠ¨æ€</span>
                            </a>
                            <a href="#" class="action-item" onclick="openSettings()">
                                <i class="fas fa-cog"></i>
                                <span>è´¦æˆ·è®¾ç½®</span>
                            </a>
                        </div>
                    </div>
                </div>

                <!-- å³ä¾§å†…å®¹åŒºåŸŸ -->
                <div class="profile-content">
                    <!-- æ ‡ç­¾é¡µå¯¼èˆª -->
                    <div class="profile-tabs">
                        <button class="tab-btn active" data-tab="overview">æ¦‚è§ˆ</button>
                        <button class="tab-btn" data-tab="bookings">çº¦çƒè®°å½•</button>
                        <button class="tab-btn" data-tab="events">èµ›äº‹è®°å½•</button>
                        <button class="tab-btn" data-tab="posts">æˆ‘çš„åŠ¨æ€</button>
                        <button class="tab-btn" data-tab="achievements">æˆå°±å¾½ç« </button>
                    </div>

                    <!-- æ¦‚è§ˆæ ‡ç­¾é¡µ -->
                    <div class="tab-content active" id="overview">
                        <!-- æ•°æ®ç»Ÿè®¡ -->
                        <div class="stats-overview">
                            <div class="stats-grid">
                                <div class="stat-card">
                                    <div class="stat-icon">
                                        <i class="fas fa-handshake"></i>
                                    </div>
                                    <div class="stat-info">
                                        <h3 id="totalBookings">0</h3>
                                        <p>æ€»çº¦çƒæ¬¡æ•°</p>
                                        <span class="stat-trend" id="bookingTrend">æš‚æ— æ•°æ®</span>
                                    </div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-icon">
                                        <i class="fas fa-trophy"></i>
                                    </div>
                                    <div class="stat-info">
                                        <h3 id="totalEvents">0</h3>
                                        <p>å‚ä¸èµ›äº‹</p>
                                        <span class="stat-trend" id="eventTrend">æš‚æ— æ•°æ®</span>
                                    </div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-icon">
                                        <i class="fas fa-medal"></i>
                                    </div>
                                    <div class="stat-info">
                                        <h3 id="totalAwards">0</h3>
                                        <p>è·å¾—å¥–é¡¹</p>
                                        <span class="stat-trend" id="awardTrend">æš‚æ— æ•°æ®</span>
                                    </div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-icon">
                                        <i class="fas fa-heart"></i>
                                    </div>
                                    <div class="stat-info">
                                        <h3 id="totalLikes">0</h3>
                                        <p>è·å¾—ç‚¹èµ</p>
                                        <span class="stat-trend" id="likeTrend">æš‚æ— æ•°æ®</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- æœ€è¿‘æ´»åŠ¨ -->
                        <div class="recent-activities">
                            <h3>æœ€è¿‘æ´»åŠ¨</h3>
                            <div class="activity-list" id="activityList">
                                <!-- åŠ¨æ€ç”Ÿæˆå†…å®¹ -->
                            </div>
                        </div>
                    </div>

                    <!-- çº¦çƒè®°å½•æ ‡ç­¾é¡µ -->
                    <div class="tab-content" id="bookings">
                        <div class="records-header">
                            <h3>çº¦çƒè®°å½•</h3>
                            <div class="filter-buttons">
                                <button class="filter-btn active" data-filter="all">å…¨éƒ¨</button>
                                <button class="filter-btn" data-filter="completed">å·²å®Œæˆ</button>
                                <button class="filter-btn" data-filter="upcoming">å³å°†è¿›è¡Œ</button>
                                <button class="filter-btn" data-filter="cancelled">å·²å–æ¶ˆ</button>
                            </div>
                        </div>
                        <div class="booking-records" id="bookingRecords">
                            <!-- åŠ¨æ€ç”Ÿæˆå†…å®¹ -->
                        </div>
                    </div>

                    <!-- èµ›äº‹è®°å½•æ ‡ç­¾é¡µ -->
                    <div class="tab-content" id="events">
                        <div class="records-header">
                            <h3>èµ›äº‹è®°å½•</h3>
                            <div class="filter-buttons">
                                <button class="filter-btn active" data-filter="all">å…¨éƒ¨</button>
                                <button class="filter-btn" data-filter="participated">å·²å‚ä¸</button>
                                <button class="filter-btn" data-filter="registered">å·²æŠ¥å</button>
                                <button class="filter-btn" data-filter="won">è·å¥–è®°å½•</button>
                            </div>
                        </div>
                        <div class="event-records" id="eventRecords">
                            <!-- åŠ¨æ€ç”Ÿæˆå†…å®¹ -->
                        </div>
                    </div>

                    <!-- æˆ‘çš„åŠ¨æ€æ ‡ç­¾é¡µ -->
                    <div class="tab-content" id="posts">
                        <div class="records-header">
                            <h3>æˆ‘çš„åŠ¨æ€</h3>
                            <div class="post-stats" id="postStats">
                                <span>å…±å‘å¸ƒ 0 æ¡åŠ¨æ€</span>
                                <span>è·å¾— 0 ç‚¹èµ</span>
                                <span>æ”¶åˆ° 0 è¯„è®º</span>
                            </div>
                        </div>
                        <div class="my-posts" id="myPosts">
                            <!-- åŠ¨æ€ç”Ÿæˆå†…å®¹ -->
                        </div>
                    </div>

                    <!-- æˆå°±å¾½ç« æ ‡ç­¾é¡µ -->
                    <div class="tab-content" id="achievements">
                        <div class="records-header">
                            <h3>æˆå°±å¾½ç« </h3>
                            <p>å±•ç¤ºæ‚¨åœ¨ä¹’ä¹“çƒç¤¾åŒºä¸­çš„æˆå°±å’Œé‡Œç¨‹ç¢‘</p>
                        </div>
                        <div class="achievements-grid" id="achievementsGrid">
                            <!-- åŠ¨æ€ç”Ÿæˆå†…å®¹ -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- ç¼–è¾‘èµ„æ–™æ¨¡æ€æ¡† -->
    <div id="editProfileModal" class="modal">
        <div class="modal-content large">
            <span class="close" onclick="closeModal('editProfileModal')">&times;</span>
            <h2>ç¼–è¾‘ä¸ªäººèµ„æ–™</h2>
            <form class="profile-form" onsubmit="event.preventDefault(); saveProfileEdit();">
                <div class="form-row">
                    <div class="form-group">
                        <label for="editName">å§“å</label>
                        <input type="text" id="editName" placeholder="è¯·è¾“å…¥æ‚¨çš„å§“å" required>
                    </div>
                    <div class="form-group">
                        <label for="editTitle">èŒä¸š/å¤´è¡”</label>
                        <input type="text" id="editTitle" placeholder="å¦‚ï¼šä¹’ä¹“çƒæ•™ç»ƒã€ä¸šä½™çˆ±å¥½è€…ç­‰">
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="editLevel">æŠ€æœ¯æ°´å¹³</label>
                        <select id="editLevel" required></select>
                    </div>
                    <div class="form-group">
                        <label for="editLocation">æ‰€åœ¨åœ°åŒº</label>
                        <input type="text" id="editLocation" placeholder="å¦‚ï¼šåŒ—äº¬å¸‚æœé˜³åŒº">
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="editBio">ä¸ªäººç®€ä»‹</label>
                    <textarea id="editBio" rows="4" placeholder="ä»‹ç»ä¸€ä¸‹æ‚¨çš„ä¹’ä¹“çƒç»å†å’Œä¸“é•¿..."></textarea>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="editPhone">è”ç³»ç”µè¯</label>
                        <input type="tel" id="editPhone" placeholder="è¯·è¾“å…¥è”ç³»ç”µè¯">
                    </div>
                    <div class="form-group">
                        <label for="editEmail">é‚®ç®±åœ°å€</label>
                        <input type="email" id="editEmail" readonly style="background: #f8f9fa; cursor: not-allowed;">
                    </div>
                </div>
                
                <div class="form-group">
                    <label>ç¤¾äº¤åª’ä½“</label>
                    <div class="social-inputs">
                        <div class="social-input">
                            <i class="fab fa-weixin"></i>
                            <input type="text" id="editWechat" placeholder="å¾®ä¿¡å·">
                        </div>
                        <div class="social-input">
                            <i class="fab fa-weibo"></i>
                            <input type="text" id="editWeibo" placeholder="å¾®åšè´¦å·">
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="checkbox-label">
                        <input type="checkbox" id="rememberMe">
                        <span class="checkmark"></span>
                        è®°ä½æˆ‘çš„ç™»å½•çŠ¶æ€
                    </label>
                </div>
                
                <div class="form-actions">
                    <button type="button" class="btn-secondary" onclick="closeModal('editProfileModal')">å–æ¶ˆ</button>
                    <button type="submit" class="btn-primary">ä¿å­˜ä¿®æ”¹</button>
                </div>
            </form>
        </div>
    </div>

    <!-- ç™»å½•æ¨¡æ€æ¡† -->
    <div id="loginModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('loginModal')">&times;</span>
            <form class="auth-form" id="loginForm">
                <h2>ç™»å½•è´¦æˆ·</h2>
                <div class="form-group">
                    <label for="loginEmail">é‚®ç®±</label>
                    <input type="email" id="loginEmail" required>
                </div>
                <div class="form-group">
                    <label for="loginPassword">å¯†ç </label>
                    <input type="password" id="loginPassword" required>
                </div>
                <div class="form-group">
                    <label class="checkbox-label">
                        <input type="checkbox" id="rememberMe">
                        <span class="checkmark"></span>
                        è®°ä½æˆ‘çš„ç™»å½•çŠ¶æ€
                    </label>
                </div>
                <button type="submit" class="btn-primary">ç™»å½•</button>
                <div class="auth-switch">
                    è¿˜æ²¡æœ‰è´¦æˆ·ï¼Ÿ<a href="#" onclick="switchModal('loginModal', 'registerModal')">ç«‹å³æ³¨å†Œ</a>
                </div>
            </form>
        </div>
    </div>

    <!-- æ³¨å†Œæ¨¡æ€æ¡† -->
    <div id="registerModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('registerModal')">&times;</span>
            <form class="auth-form" id="registerForm">
                <h2>æ³¨å†Œè´¦æˆ·</h2>
                <div class="form-group">
                    <label for="registerName">å§“å</label>
                    <input type="text" id="registerName" required>
                </div>
                <div class="form-group">
                    <label for="registerEmail">é‚®ç®±</label>
                    <input type="email" id="registerEmail" required>
                </div>
                <div class="form-group">
                    <label for="registerPassword">å¯†ç </label>
                    <input type="password" id="registerPassword" required>
                </div>
                <div class="form-group">
                    <label for="registerLevel">æŠ€æœ¯æ°´å¹³</label>
                    <select id="registerLevel" required>
                        <!-- æŠ€æœ¯æ°´å¹³é€‰é¡¹å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                    </select>
                </div>
                <div class="form-group">
                    <label for="registerLocation">æ‰€åœ¨åœ°åŒº</label>
                    <input type="text" id="registerLocation" placeholder="ä¾‹å¦‚ï¼šåŒ—äº¬å¸‚æœé˜³åŒº">
                </div>
                <button type="submit" class="btn-primary">æ³¨å†Œ</button>
                <div class="auth-switch">
                    å·²æœ‰è´¦æˆ·ï¼Ÿ<a href="#" onclick="switchModal('registerModal', 'loginModal')">ç«‹å³ç™»å½•</a>
                </div>
            </form>
        </div>
    </div>

    <!-- é¡µè„š -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <div class="footer-user-info"></div>
                    <p>å…¨çƒä¹’ä¹“çƒçˆ±å¥½è€…çš„èšé›†åœ°ï¼Œåˆ†äº«æŠ€å·§ï¼Œç»“è¯†çƒå‹ï¼Œå…±åŒè¿›æ­¥</p>
                    <div class="social-links">
                        <a href="#"><i class="fab fa-weixin"></i></a>
                        <a href="#"><i class="fab fa-weibo"></i></a>
                        <a href="#"><i class="fab fa-qq"></i></a>
                        <a href="#"><i class="fab fa-douyin"></i></a>
                    </div>
                </div>
                <div class="footer-section">
                    <h3>ç¤¾åŒºå¯¼èˆª</h3>
                    <ul>
                        <li><a href="index.html">é¦–é¡µ</a></li>
                        <li><a href="booking.html">çº¦çƒä¸­å¿ƒ</a></li>
                        <li><a href="events.html">èµ›äº‹æ´»åŠ¨</a></li>
                        <li><a href="community.html">ç¤¾åŒºåŠ¨æ€</a></li>
                        <li><a href="#">æŠ€æœ¯äº¤æµ</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h3>å¸®åŠ©æ”¯æŒ</h3>
                    <ul>
                        <li><a href="#">ä½¿ç”¨æŒ‡å—</a></li>
                        <li><a href="#">å¸¸è§é—®é¢˜</a></li>
                        <li><a href="#">è”ç³»å®¢æœ</a></li>
                        <li><a href="#">æ„è§åé¦ˆ</a></li>
                        <li><a href="#">å¼€å‘è€…API</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h3>è”ç³»ä½œè€…</h3>
                    <p><i class="fas fa-envelope"></i> xjy1369231377@outlook.com</p>
                    <p><i class="fab fa-weixin"></i> å¾®ä¿¡ï¼šqzwdxjy</p>
                    <p><i class="fab fa-qq"></i> QQï¼š1369231377</p>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2024 SpinMatch. ä¿ç•™æ‰€æœ‰æƒåˆ©. | <a href="#">éšç§æ”¿ç­–</a> | <a href="#">æœåŠ¡æ¡æ¬¾</a></p>
            </div>
        </div>
    </footer>

    <!-- é¡µé¢åˆå§‹åŒ–è„šæœ¬ -->
    <script>
        // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            // ç«‹å³å®šä¹‰æ¨¡æ€æ¡†å‡½æ•°ï¼Œç¡®ä¿æŒ‰é’®ç‚¹å‡»æ—¶å¯ç”¨
            window.openModal = function(modalId) {
                console.log('ğŸ”¥ å°è¯•æ‰“å¼€æ¨¡æ€æ¡†:', modalId);
                const modal = document.getElementById(modalId);
                if (modal) {
                    modal.classList.add('show');
                    modal.style.display = 'flex';
                    modal.style.zIndex = '10000';
                    document.body.style.overflow = 'hidden';
                    console.log('âœ… æ¨¡æ€æ¡†å·²æ‰“å¼€:', modalId);
                } else {
                    console.error('âŒ æ‰¾ä¸åˆ°æ¨¡æ€æ¡†:', modalId);
                }
            };
            
            window.closeModal = function(modalId) {
                console.log('ğŸ”¥ å°è¯•å…³é—­æ¨¡æ€æ¡†:', modalId);
                const modal = document.getElementById(modalId);
                if (modal) {
                    modal.classList.remove('show');
                    modal.style.display = 'none';
                    document.body.style.overflow = 'auto';
                    console.log('âœ… æ¨¡æ€æ¡†å·²å…³é—­:', modalId);
                } else {
                    console.error('âŒ æ‰¾ä¸åˆ°æ¨¡æ€æ¡†:', modalId);
                }
            };
            
            window.switchModal = function(from, to) {
                console.log('ğŸ”¥ åˆ‡æ¢æ¨¡æ€æ¡†:', from, 'â†’', to);
                window.closeModal(from);
                window.openModal(to);
            };
            
            // è°ƒè¯•ï¼šæ£€æŸ¥è®¤è¯æ¨¡å—æ˜¯å¦åŠ è½½
            console.log('ğŸ” æ£€æŸ¥è®¤è¯æ¨¡å—åŠ è½½çŠ¶æ€:');
            console.log('- window.authModule:', window.authModule ? 'âœ… å·²åŠ è½½' : 'âŒ æœªåŠ è½½');
            console.log('- window.openModal:', typeof window.openModal === 'function' ? 'âœ… å¯ç”¨' : 'âŒ ä¸å¯ç”¨');
            console.log('- window.closeModal:', typeof window.closeModal === 'function' ? 'âœ… å¯ç”¨' : 'âŒ ä¸å¯ç”¨');
            
            // æµ‹è¯•ï¼šæ£€æŸ¥æ¨¡æ€æ¡†å…ƒç´ æ˜¯å¦å­˜åœ¨
            console.log('ğŸ” æ£€æŸ¥æ¨¡æ€æ¡†å…ƒç´ :');
            console.log('- loginModal:', document.getElementById('loginModal') ? 'âœ… å­˜åœ¨' : 'âŒ ä¸å­˜åœ¨');
            console.log('- registerModal:', document.getElementById('registerModal') ? 'âœ… å­˜åœ¨' : 'âŒ ä¸å­˜åœ¨');
            
            // æ·»åŠ æŒ‰é’®ç‚¹å‡»äº‹ä»¶ç›‘å¬å™¨è¿›è¡Œè°ƒè¯•
            const loginBtn = document.querySelector('.btn-login');
            const registerBtn = document.querySelector('.btn-register');
            
            console.log('ğŸ” æ£€æŸ¥æŒ‰é’®å…ƒç´ :');
            console.log('- ç™»å½•æŒ‰é’®:', loginBtn ? 'âœ… å­˜åœ¨' : 'âŒ ä¸å­˜åœ¨');
            console.log('- æ³¨å†ŒæŒ‰é’®:', registerBtn ? 'âœ… å­˜åœ¨' : 'âŒ ä¸å­˜åœ¨');
            
            if (loginBtn) {
                loginBtn.addEventListener('click', function(e) {
                    console.log('ğŸ¯ ç™»å½•æŒ‰é’®è¢«ç‚¹å‡»äº†ï¼', e);
                    e.preventDefault();
                    window.openModal('loginModal');
                });
            }
            
            if (registerBtn) {
                registerBtn.addEventListener('click', function(e) {
                    console.log('ğŸ¯ æ³¨å†ŒæŒ‰é’®è¢«ç‚¹å‡»äº†ï¼', e);
                    e.preventDefault();
                    window.openModal('registerModal');
                });
            }
            
            // æ·»åŠ æ¨¡æ€æ¡†èƒŒæ™¯ç‚¹å‡»å…³é—­åŠŸèƒ½
            document.addEventListener('click', function(e) {
                if (e.target.classList.contains('modal') && e.target.classList.contains('show')) {
                    console.log('ğŸ¯ æ¨¡æ€æ¡†èƒŒæ™¯è¢«ç‚¹å‡»ï¼Œå…³é—­æ¨¡æ€æ¡†');
                    const modalId = e.target.id;
                    window.closeModal(modalId);
                }
            });
            
            // æ·»åŠ ESCé”®å…³é—­æ¨¡æ€æ¡†åŠŸèƒ½
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') {
                    const openModal = document.querySelector('.modal.show');
                    if (openModal) {
                        console.log('ğŸ¯ ESCé”®è¢«æŒ‰ä¸‹ï¼Œå…³é—­æ¨¡æ€æ¡†');
                        window.closeModal(openModal.id);
                    }
                }
            });
            
            // è®¾ç½®é»˜è®¤å¤´åƒ
            const avatarElement = document.getElementById('profileAvatar');
            if (avatarElement && !avatarElement.src) {
                avatarElement.src = DEFAULT_AVATAR;
            }
            
            // åˆå§‹åŒ–æ‰€æœ‰è¡¨å•é€‰é¡¹
            initializeAllForms();
            
            // åˆå§‹åŒ–ç©ºçŠ¶æ€æ˜¾ç¤º
            initializeEmptyStates();
            
            // åˆå§‹åŒ–æˆå°±å¾½ç« 
            initializeAchievements();
            
            // æ£€æŸ¥æ˜¯å¦å·²ç»ç™»å½•
            checkLoginStatus();
        });

        // ç»Ÿä¸€åˆå§‹åŒ–æ‰€æœ‰è¡¨å•é€‰é¡¹
        function initializeAllForms() {
            // ç¼–è¾‘èµ„æ–™è¡¨å•çš„æŠ€æœ¯æ°´å¹³é€‰é¡¹
            const editLevelSelect = document.getElementById('editLevel');
            if (editLevelSelect) {
                editLevelSelect.innerHTML = generateLevelOptions();
            }
            
            // æ³¨å†Œè¡¨å•çš„æŠ€æœ¯æ°´å¹³é€‰é¡¹
            const registerLevelSelect = document.getElementById('registerLevel');
            if (registerLevelSelect) {
                registerLevelSelect.innerHTML = generateLevelOptions(true);
            }
        }

        // ç”Ÿæˆç©ºçŠ¶æ€HTMLçš„é€šç”¨å‡½æ•°
        function generateEmptyState(iconClass, title, description, buttonText, buttonLink) {
            return `
                <div class="no-records">
                    <i class="${iconClass}"></i>
                    <p>${title}</p>
                    <span>${description}</span>
                    ${buttonText && buttonLink ? `<a href="${buttonLink}" class="btn-primary">${buttonText}</a>` : ''}
                </div>
            `;
        }

        // åˆå§‹åŒ–æ‰€æœ‰ç©ºçŠ¶æ€
        function initializeEmptyStates() {
            // ä½¿ç”¨ç»Ÿä¸€çš„ç©ºçŠ¶æ€é…ç½®
            const emptyStates = [
                {
                    id: 'activityList',
                    config: {
                        icon: 'fas fa-calendar-alt',
                        title: 'æš‚æ— æ´»åŠ¨è®°å½•', 
                        description: 'å¼€å§‹æ‚¨çš„ä¹’ä¹“çƒä¹‹æ—…å§ï¼'
                    }
                },
                {
                    id: 'bookingRecords',
                    config: {
                        icon: 'fas fa-handshake',
                        title: 'æš‚æ— çº¦çƒè®°å½•',
                        description: 'å»çº¦çƒä¸­å¿ƒå‘å¸ƒæ‚¨çš„ç¬¬ä¸€ä¸ªçº¦çƒå§ï¼',
                        buttonText: 'ç«‹å³çº¦çƒ',
                        buttonLink: 'booking.html'
                    }
                },
                {
                    id: 'eventRecords', 
                    config: {
                        icon: 'fas fa-trophy',
                        title: 'æš‚æ— èµ›äº‹è®°å½•',
                        description: 'å»èµ›äº‹ä¸­å¿ƒå‚åŠ æ‚¨çš„ç¬¬ä¸€ä¸ªèµ›äº‹å§ï¼',
                        buttonText: 'æŸ¥çœ‹èµ›äº‹',
                        buttonLink: 'events.html'
                    }
                },
                {
                    id: 'myPosts',
                    config: {
                        icon: 'fas fa-pen',
                        title: 'æš‚æ— åŠ¨æ€å‘å¸ƒ',
                        description: 'å»ç¤¾åŒºåˆ†äº«æ‚¨çš„ä¹’ä¹“çƒå¿ƒå¾—å§ï¼',
                        buttonText: 'å‘å¸ƒåŠ¨æ€', 
                        buttonLink: 'community.html'
                    }
                }
            ];

            // æ‰¹é‡ç”Ÿæˆç©ºçŠ¶æ€
            emptyStates.forEach(state => {
                const element = document.getElementById(state.id);
                if (element) {
                    const { icon, title, description, buttonText, buttonLink } = state.config;
                    element.innerHTML = generateEmptyState(icon, title, description, buttonText, buttonLink);
                }
            });
        }

        // åˆå§‹åŒ–æˆå°±å¾½ç« 
        function initializeAchievements() {
            const achievementsGrid = document.getElementById('achievementsGrid');
            if (!achievementsGrid) return;
            
            let achievementsHTML = '';
            ACHIEVEMENT_DATA.forEach(achievement => {
                achievementsHTML += generateAchievementItem(achievement, false, 0);
            });
            
            achievementsGrid.innerHTML = achievementsHTML;
        }
        
        // æ˜¾ç¤ºé€šçŸ¥æ¶ˆæ¯ - å§”æ‰˜ç»™auth-moduleé¿å…é‡å¤é€šçŸ¥
        function showNotification(message, type = 'info', duration = 5000) {
            // å¦‚æœauth-moduleå¯ç”¨ï¼Œä½¿ç”¨å®ƒçš„é€šçŸ¥ç³»ç»Ÿ
            if (window.authModule && typeof window.authModule.showNotification === 'function') {
                window.authModule.showNotification(message, type, duration);
                return;
            }
            
            // å¦åˆ™ä½¿ç”¨æœ¬åœ°é€šçŸ¥ç³»ç»Ÿï¼ˆä½œä¸ºåå¤‡ï¼‰
            console.log(`é€šçŸ¥: ${message} (${type})`);
        }
        
        // æ›´æ–°ç”¨æˆ·ç•Œé¢
        function updateUserInterface(userData) {
            console.log('ğŸ”„ æ›´æ–°ç”¨æˆ·ç•Œé¢:', userData);
            
            // æ›´æ–°ä¸ªäººèµ„æ–™æ˜¾ç¤º
            const profileName = document.getElementById('profileName');
            const profileLevel = document.getElementById('profileLevel');
            const profileLocation = document.getElementById('profileLocation');
            
            if (profileName) profileName.textContent = userData.name || 'ç”¨æˆ·';
            if (profileLevel) {
                profileLevel.textContent = getLevelText(userData.level || 'beginner');
                profileLevel.className = `user-level ${userData.level || 'beginner'}`;
            }
            if (profileLocation && userData.location) {
                profileLocation.textContent = userData.location;
            }
            
            // éšè—ç™»å½•æ³¨å†ŒæŒ‰é’®ï¼Œæ˜¾ç¤ºç”¨æˆ·èœå•
            const navAuth = document.querySelector('.nav-auth');
            if (navAuth) {
                navAuth.innerHTML = `
                    <div class="user-menu">
                        <span class="username">æ¬¢è¿ï¼Œ${userData.name}</span>
                        <button class="btn-logout" onclick="handleLogout()">é€€å‡º</button>
                    </div>
                `;
            }
        }
        
        // è·å–æŠ€æœ¯æ°´å¹³æ–‡æœ¬
        function getLevelText(level) {
            const levels = {
                'beginner': 'åˆå­¦è€…',
                'intermediate': 'ä¸­çº§',
                'advanced': 'é«˜çº§',
                'professional': 'ä¸“ä¸š'
            };
            return levels[level] || 'åˆå­¦è€…';
        }
        
        // å¤„ç†é€€å‡ºç™»å½•
        function handleLogout() {
            console.log('ğŸ‘‹ ç”¨æˆ·é€€å‡ºç™»å½•');
            
            // æ¸…é™¤å­˜å‚¨çš„ç”¨æˆ·ä¿¡æ¯
            localStorage.removeItem('spinmatch_user');
            localStorage.removeItem('spinmatch_logged_in');
            sessionStorage.removeItem('spinmatch_user');
            sessionStorage.removeItem('spinmatch_logged_in');
            
            // æ˜¾ç¤ºé€€å‡ºæ¶ˆæ¯
            showNotification('å·²æˆåŠŸé€€å‡ºç™»å½•', 'info');
            
            // æ¢å¤ç™»å½•æ³¨å†ŒæŒ‰é’®
            const navAuth = document.querySelector('.nav-auth');
            if (navAuth) {
                navAuth.innerHTML = `
                    <button class="btn-login" onclick="openModal('loginModal')">ç™»å½•</button>
                    <button class="btn-register" onclick="openModal('registerModal')">æ³¨å†Œ</button>
                `;
            }
            
            // é‡ç½®ä¸ªäººèµ„æ–™æ˜¾ç¤º
            const profileName = document.getElementById('profileName');
            const profileLevel = document.getElementById('profileLevel');
            const profileLocation = document.getElementById('profileLocation');
            
            if (profileName) profileName.textContent = 'æ‚¨çš„å§“å';
            if (profileLevel) {
                profileLevel.textContent = 'æŠ€æœ¯æ°´å¹³';
                profileLevel.className = 'user-level';
            }
            if (profileLocation) profileLocation.textContent = 'æ‰€åœ¨åœ°åŒº';
        }
        
        // æ£€æŸ¥ç™»å½•çŠ¶æ€
        function checkLoginStatus() {
            const user = localStorage.getItem('spinmatch_user') || sessionStorage.getItem('spinmatch_user');
            const isLoggedIn = localStorage.getItem('spinmatch_logged_in') || sessionStorage.getItem('spinmatch_logged_in');
            
            if (user && isLoggedIn === 'true') {
                try {
                    const userData = JSON.parse(user);
                    console.log('ğŸ”„ å‘ç°å·²ç™»å½•ç”¨æˆ·:', userData);
                    updateUserInterface(userData);
                } catch (error) {
                    console.error('âŒ ç”¨æˆ·æ•°æ®è§£æå¤±è´¥:', error);
                    // æ¸…é™¤æ— æ•ˆæ•°æ®
                    localStorage.removeItem('spinmatch_user');
                    localStorage.removeItem('spinmatch_logged_in');
                    sessionStorage.removeItem('spinmatch_user');
                    sessionStorage.removeItem('spinmatch_logged_in');
                }
            }
        }
    </script>

    <script src="../scripts/profile.js"></script>
    <script src="../scripts/page-transitions.js"></script>
    
    <!-- è®¤è¯æ¨¡å— - æ”¾åœ¨æœ€åç¡®ä¿DOMå·²åŠ è½½ -->
    <script src="../scripts/auth-module.js"></script>
</body>
</html> 